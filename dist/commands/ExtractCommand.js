import{existsSync as r,mkdirSync as t,readFileSync as e,writeFileSync as o}from"node:fs";import{basename as i,dirname as n,normalize as f}from"node:path";import{fatal as $}from"@triforce-heroes/triforce-core";import{extract as m}from"../Extract.js";export function ExtractCommand(a,c){r(a)||$(`File not found: ${a}`);let s=n(a),d=i(a,".rarc"),p=f(c??`${s}/${d}`);for(let r of(process.stdout.write(`Extracting ${f(a)} to ${p}... `),m(e(a)))){let e="ROOT"===r.identifier?"":`${r.identifier}$`,i="ROOT"===r.identifier&&r.name===d?f(`${s}/${e}${r.name}`):f(`${p}/${e}${r.name}`);for(let e of(t(i,{recursive:!0}),r.entries))o(`${i}/${e.name}`,e.data)}process.stdout.write("OK\n")}