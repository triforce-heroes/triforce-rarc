import{existsSync as r,mkdirSync as e,readFileSync as o,writeFileSync as t}from"node:fs";import{normalize as i}from"node:path";import{BufferConsumer as f,fatal as n}from"@triforce-heroes/triforce-core";import{parser as s}from"../parser/parser.js";export function ExtractCommand(m,a){r(m)||n(`File not found: ${m}`);let p=i(a??`${m}.out`);for(let r of(process.stdout.write(`Extracting ${i(m)} to ${p}... `),s.parse(new f(o(m),void 0,1)))){let o="ROOT"===r.identifier?"":`${r.identifier}$`,f=i(`${p}/${o}${r.name}`);for(let o of(e(f,{recursive:!0}),r.entries))t(`${f}/${o.name}`,o.data)}process.stdout.write("OK\n")}